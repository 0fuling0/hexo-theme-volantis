<% (theme.plugins.prismjs.js||[]).forEach(function(item) { %>
  <%- js(item) %>
<% }) %>
<% (theme.plugins.prismjs.css||[]).forEach(function(item) { %>
  <%- css(item) %>
<% }) %>
<style>
  /* .btn-copy 对于 prismjs 有 bug */
  .btn-copy{
    display: none;
  }
</style>

<script>
  try {
    Prism.plugins.toolbar.registerButton('copy-code', function(env) {
      var button = document.createElement('button');
      button.innerHTML = 'Copy Code';

      button.addEventListener('click', function () {
        try {
          const range = new Range();
          range.selectNodeContents(env.element);
          document.getSelection().removeAllRanges();
          document.getSelection().addRange(range);
          navigator.clipboard.writeText(document.getSelection().toString())
        } catch (e) {
          console.log(e);
          console.log('当前浏览器不支持复制功能，请检查更新或更换其他浏览器操作!');
        }
      });
      return button;
    });
  } catch (e) {
    console.log(e);
  }
</script>